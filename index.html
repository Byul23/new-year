<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>New Year üíõ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg: #fffdf2;
  --card: #fff4c1;
  --accent: #f6d365;
  --text: #3b2f1c;
}

body {
  margin: 0;
  font-family: Poppins, Arial, sans-serif;
  background: linear-gradient(180deg, #fffdf2, #fff1a8);
  color: var(--text);
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 20px;
}

.card {
  background: var(--card);
  border-radius: 22px;
  padding: 24px;
  box-shadow: 0 15px 40px rgba(246,211,101,.35);
}

h1 {
  text-align: center;
  background: linear-gradient(90deg, #f6d365, #fda085);
  -webkit-background-clip: text;
  color: transparent;
}

#countdown {
  text-align: center;
  font-size: 1.6rem;
  margin: 20px 0;
}

button {
  background: linear-gradient(135deg, #f6d365, #fda085);
  border: none;
  padding: 12px 18px;
  border-radius: 14px;
  color: white;
  font-weight: bold;
  cursor: pointer;
}

input, textarea {
  width: 100%;
  padding: 10px;
  border-radius: 12px;
  border: none;
  margin-top: 10px;
}

.hidden { display: none; }

.tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.tab {
  flex: 1;
  text-align: center;
  padding: 10px;
  border-radius: 12px;
  background: #ffeaa7;
  cursor: pointer;
}

.tab.active {
  background: linear-gradient(135deg,#f6d365,#fda085);
  color: white;
}

.media img {
  max-width: 100%;
  border-radius: 12px;
  margin-top: 10px;
}

.media a {
  display: block;
  margin-top: 8px;
  color: #b8860b;
}
</style>
</head>

<body>

<div class="container">

<!-- PUBLIC -->
<div id="public" class="card">
  <h1 id="title">Counting Down to 2026 üíõ</h1>
  <div id="countdown"></div>

  <div id="reveal" class="hidden">
    <h1 id="greeting">Happy New Year, my love üåº</h1>
    <p id="message">Every year is better with you.</p>
    <iframe id="spotify" style="border-radius:12px"
      width="100%" height="152"
      frameborder="0"
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture">
    </iframe>
    <div id="mediaPublic" class="media"></div>
  </div>

  <button onclick="login()">Editor Login</button>
</div>

<!-- EDITOR -->
<div id="editor" class="card hidden">
  <h1>Editor Panel ‚ú®</h1>

  <div class="tabs">
    <div class="tab active" onclick="showTab('content')">‚úçÔ∏è Content</div>
    <div class="tab" onclick="showTab('media')">üñºÔ∏è Media</div>
    <div class="tab" onclick="showTab('music')">üé∂ Spotify</div>
    <div class="tab" onclick="showTab('preview')">üëÄ Preview</div>
  </div>

  <div id="content">
    <input id="editTitle" placeholder="Title">
    <textarea id="editGreeting" placeholder="Greeting"></textarea>
    <textarea id="editMessage" placeholder="Message"></textarea>
  </div>

  <div id="media" class="hidden">
    <input type="file" id="fileUpload" accept="image/*,.pdf">
    <button onclick="addFile()">Add File</button>
    <div id="mediaEditor" class="media"></div>
  </div>

  <div id="music" class="hidden">
    <p>Paste Spotify Embed URL</p>
    <input id="spotifyInput" placeholder="https://open.spotify.com/embed/...">
  </div>

  <div id="preview" class="hidden">
    <button onclick="forceReveal()">Preview After Midnight</button>
    <div id="previewBox" class="card" style="margin-top:15px"></div>
  </div>

  <button onclick="closeEditor()">Exit Editor</button>
</div>

</div>

<script>
const TARGET = new Date("Jan 1, 2026 00:00:00").getTime();
const PASSWORD = "love2026";

/* Countdown */
function updateCountdown() {
  const diff = TARGET - Date.now();
  if (diff <= 0) showReveal();
  else {
    const d = Math.floor(diff/86400000);
    const h = Math.floor(diff/3600000)%24;
    const m = Math.floor(diff/60000)%60;
    const s = Math.floor(diff/1000)%60;
    countdown.innerText = `${d}d ${h}h ${m}m ${s}s`;
  }
}
setInterval(updateCountdown,1000);
updateCountdown();

function showReveal() {
  countdown.classList.add("hidden");
  reveal.classList.remove("hidden");
}

/* Editor */
function login() {
  if (prompt("Password") === PASSWORD) {
    public.classList.add("hidden");
    editor.classList.remove("hidden");
    loadData();
  }
}

function closeEditor() {
  editor.classList.add("hidden");
  public.classList.remove("hidden");
}

function showTab(id) {
  document.querySelectorAll("#editor > div:not(.tabs)").forEach(d=>d.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  event.target.classList.add("active");
}

/* Save text */
["editTitle","editGreeting","editMessage"].forEach(id=>{
  document.getElementById(id).oninput = ()=>{
    localStorage.setItem(id, document.getElementById(id).value);
    title.innerText = localStorage.getItem("editTitle");
    greeting.innerText = localStorage.getItem("editGreeting");
    message.innerText = localStorage.getItem("editMessage");
  }
});

/* Files */
function addFile() {
  const file = fileUpload.files[0];
  const reader = new FileReader();
  reader.onload = ()=>{
    const data = JSON.parse(localStorage.getItem("files")) || [];
    data.push({name:file.name, src:reader.result});
    localStorage.setItem("files", JSON.stringify(data));
    renderFiles();
  };
  reader.readAsDataURL(file);
}

function renderFiles() {
  mediaEditor.innerHTML = mediaPublic.innerHTML = "";
  const data = JSON.parse(localStorage.getItem("files")) || [];
  data.forEach(f=>{
    if (f.src.startsWith("data:image")) {
      const img = document.createElement("img");
      img.src = f.src;
      mediaEditor.appendChild(img.cloneNode());
      mediaPublic.appendChild(img);
    } else {
      const a = document.createElement("a");
      a.href = f.src; a.textContent = f.name; a.target="_blank";
      mediaEditor.appendChild(a.cloneNode(true));
      mediaPublic.appendChild(a);
    }
  });
}

/* Spotify */
spotifyInput.oninput = ()=>{
  localStorage.setItem("spotify", spotifyInput.value);
  spotify.src = spotifyInput.value;
};

/* Preview */
function forceReveal() {
  previewBox.innerHTML = reveal.outerHTML;
  previewBox.querySelector("#countdown")?.remove();
}

/* Load */
function loadData() {
  editTitle.value = localStorage.getItem("editTitle") || title.innerText;
  editGreeting.value = localStorage.getItem("editGreeting") || greeting.innerText;
  editMessage.value = localStorage.getItem("editMessage") || message.innerText;
  spotify.src = localStorage.getItem("spotify") || "";
  spotifyInput.value = spotify.src;
  renderFiles();
}
</script>

</body>
</html>
